---
title: "Homework Unit 2: EDA Cleaning"
author: "Your name here"
date: "`r lubridate::today()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

Welcome to your first homework assignment! Please enter your first and last name at the top of this document where it says "Your name here".

Everything you need to complete this assignment can be downloaded from the course web book. This includes:

**Two markdown files (hw_unit_2_cleaning.qmd and hw_unit_2_modeling.qmd):** 
To complete this homework (and the other homeworks) type all responses directly into these Quarto markdown files. To learn more about Quarto and working in markdown files, see the Quarto chapter of R for Data Science 2E and [help on markdown]9https://quarto.org/docs/authoring/markdown-basics.html) on the Quarto website

**ames_raw_class.csv**:
The `.csv` file containing the data set to be used in this assignment.

**ames_data_dictionary.pdf:**
The data dictionary describing variables contained in the data set.

Some code chunks, like the `conflicts` and `packages` chunks below, will be pre-filled with code for you to run. Other code chunks will be empty with text instructions above them describing code for you to fill in.

This code chunk will set up conflict policies to reduce errors associated with function conflicts
```{r conflicts}
options(conflicts.policy = "depends.ok")
devtools::source_url("https://github.com/jjcurtin/lab_support/blob/main/fun_ml.R?raw=true")
tidymodels_conflictRules()
```

This code chunk loads all packages you will need for this assignment.
```{r packages}
#| message: false
#| warning: false
library(janitor, include.only = "clean_names")
library(kableExtra, exclude = "group_rows")
library(tidyverse) # for general data wrangling
library(tidymodels) # for modeling
```

You may also use the EDA and plotting functions that John shares on his `lab_support` repo.  You can source the scripts that contain those functions directly from Github with the code below (note that you may need to install the `devtools` package if you haven't done this previously).

```{r source}
#| message: false
#| warning: false
devtools::source_url("https://github.com/jjcurtin/lab_support/blob/main/fun_eda.R?raw=true")
devtools::source_url("https://github.com/jjcurtin/lab_support/blob/main/fun_plots.R?raw=true")
``` 

## 1 Set up and load data
### 1.1 Paths and source files

<!--Future TAs, lets update this section to describe how they should setup a project on their computer in a folder named iaml.  Inside that folder, they can have a subfolder for "homework" and folders within that for each unit; e.g. unit_2. etc.  We will assume this sort of organization with our paths.-->

When you download the homework files, we recommend saving all files in a folder named "unit_2". You can also assign a path variable to easily open files.

In the chunk below, set the variable `path_data` to the location of your data files. 

In markdown, when  you are talking about variables, R functions, etc., you can display that code distinctly (with a grey background) when the script is rendered by surrounding the text with `.  We will use this in the web book and our homework scripts 

Note that other mathematical elements in markdown are by convention surrounded by `$` when specifying them inline. This renders the enclosed element in a distinct typeset when rendered. You'll learn more about this notation later, but it is especially useful when composing mathematical elements (like equations) in your notebooks. 

For example: 2^2 + 4 = 8$

Make sure you have your iaml project open in RStudio.  When you call `here::here()` it will set your root path to be inside of the iaml folder.   Assuming you have a subfolder called homework and a folder within that folder called `unit_2`, `path_data` will work as set.  If you have some other organization, you will need to modify `path_data` to reflect that folder structure.
```{r path}
path_data <- "homework/unit_2"
```


### 1.2 Load data

This assignment will use the Ames Housing Prices Dataset (also seen in Unit 2 of the course text).

Load the `ames_raw_class.csv` data below.
```{r load-data}

```

### 1.3 Select variables
We will explore a different set of variables than those demoed in the course text. `select()` from the dataset for the variables below and convert all variable names to "snake_case":

`SalePrice`, `Garage Area`, `Neighborhood`, `MS SubClass`, `Total Bsmt SF`, `Bsmt Qual`, `Central Air`, `TotRms`, `AbvGrd`, `Fireplaces`, and `Fireplace Qu`.

```{r select-data}

```

### 1.4 Review the data dictionary

Familiarize yourself with the variables we will be using by looking each one up in the data dictionary downloaded with your homework files. Reference the codebook frequently as you perform cleaning checks below.

## 2 Exploring the data for cleaning
This script should only contain EDA steps necessary for cleaning the full dataset (i.e., not subsets of it that will be allocated for train, vaidation, or test). Be mindful of which aspects of the data set you explore at this stage to prevent information leakage between later training and validation sets (to be saved out as the final step of cleaning in this document). Provide observations at each stage of the process, even if you do not make any changes.

### 2.1 Variable classes

<!--UPDATE TO DISCUSS CLASSING CATEGORICAL AS FACTOR-->

Confirm that all variables are read in as the expected class. Below the code chunk, type some observations you have about the observed variable classes compared to descriptions in the data dictionary. Make any appropriate adjustments to variable class below using `mutate()`, `factor()`, or `as.numeric()`.


```{r clean-class}

```

**Variable class notes:**
*Enter your notes here*

Type your text observation between the two single asterisks (`*`) above. Asterisks are a way to format text in markdown files that is displayed once the completed file is "rendered" to a html format. Surrounding text with **two asterisks per side** creates **bold** text, while surrounding text with *one asterisk per side* creates *italicized* text. Italicizing makes your text responses a little easier for us to find while grading homework, and we are grateful to you for using it.

### 2.2 Missing data
Use an appropriate technique to review missing data at this stage. Clearly document missing data ("missingness") across each variable in the dataset. For variables with high missingness, write code that allows you to visually inspect all observations of missing data (for each such variable). Using information from related variables and the data dictionary to guide you, speculate (in prose) why data may be missing. Clean variables with high missingness using `mutate()`, `replace_na()`, and `fct_relevel()`

```{r clean-missing}

```

**Missing data notes:**
*Enter your notes here*

### 2.3 Numeric variables

Explore `min` and `max` values for numeric variables, recording notes on any observations that look suspicious or potentially invalid. Use the data dictionary and associated variables to help you decide whether suspicious observations may represent (in)valid responses.

```{r clean-numeric}

```

**Numeric variable notes:**
*Enter your notes here*

### 2.4 Categorical variables

<!-- no longer need print_responses now that we use factors.  just use levels() and maybe print().  See book-->
<!-- can tidy levels with tidy_responses() function-->
<!--don use recode() use fct_recode().  See book-->
Use `walk2()` and the `print_responses()` function to print the levels of each categorical variable. Convert all responses to snake_case and check to make sure all levels converted properly. If needed, correct any response levels with conversion errors using `mutate()` and `recode()`. Document your observations for categorical levels.

```{r clean-categorical}

```

**Categorical variable notes:**
*Enter your notes here*


## 3 Train test split
Now that we have completed our data cleaning, we will split our data into train and test sets and save out the cleaned files. Since John held out a separate test set from the data we were given, your split will actually create our training and validation sets. We will use his holdout set as the test data.

### 3.1 Generate a train/test split
Assign 25% of the data to be our validation set. Stratify this split on the `sale_price` variable.

```{r split-train}

```


### 3.2 Save cleaned files
Save out your cleaned train and validation sets as csv files and name them `hw_unit_2_train.csv` and `hw_unit_2_val.csv`.

```{r save-files}

```

## 4 Save and knit 

### 4.1 Save
Save this `.qmd` file with your last name at the end (e.g. `hw_unit_2_marji.qmd`)

### 4.2 Knit
Click the "render" button at the top of your screen to render the file to html. Upload this html file to Canvas to submit the first part of the assignment. Take care not to rest on your laurels: you have a 2nd part to do (but we are proud of your for getting this far!).